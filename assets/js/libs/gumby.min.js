!function(){"use strict";function Gumby(){this.$dom=$(document);this.isOldie=!!this.$dom.find("html").hasClass("oldie");this.click="click";this.onReady=this.onOldie=this.onTouch=false;this.uiModules={};this.inits={};this.path=$("script[gumby-path]").attr("gumby-path")||"js/libs";this.breakpoint=Number($("script[gumby-breakpoint]").attr("gumby-breakpoint"))||1024}Gumby.prototype.init=function(){var scope=this;this.$dom.ready(function(){scope.initUIModules();if(scope.onReady){scope.onReady()}if(scope.isOldie&&scope.onOldie){scope.onOldie()}if(Modernizr.touch&&scope.onTouch){scope.onTouch()}})};Gumby.prototype.ready=function(code){if(code&&typeof code==="function"){this.onReady=code}};Gumby.prototype.oldie=function(code){if(code&&typeof code==="function"){this.onOldie=code}};Gumby.prototype.touch=function(code){if(code&&typeof code==="function"){this.onTouch=code}};Gumby.prototype.debug=function(){return{$dom:this.$dom,isOldie:this.isOldie,uiModules:this.uiModules,click:this.click}};Gumby.prototype.selectAttr=function(){var i=0;for(;i<arguments.length;i++){var attr=arguments[i],dataAttr="data-"+arguments[i],gumbyAttr="gumby-"+arguments[i];if(this.is("["+dataAttr+"]")){return this.attr(dataAttr)?this.attr(dataAttr):true}else if(this.is("["+gumbyAttr+"]")){return this.attr(gumbyAttr)?this.attr(gumbyAttr):true}else if(this.is("["+attr+"]")){return this.attr(attr)?this.attr(attr):true}}return false};Gumby.prototype.addInitalisation=function(ref,code){this.inits[ref]=code};Gumby.prototype.initialize=function(ref,all){if(this.inits[ref]&&typeof this.inits[ref]==="function"){this.inits[ref](all)}};Gumby.prototype.UIModule=function(data){var module=data.module;this.uiModules[module]=data};Gumby.prototype.initUIModules=function(){var x;for(x in this.uiModules){this.uiModules[x].init()}};window.Gumby=new Gumby}();!function(){"use strict";function Retina($el){this.$el=$el;this.imageSrc=this.$el.attr("src");this.retinaSrc=this.fetchRetinaImage();this.$retinaImg=$(new Image);var scope=this;if(!this.retinaSrc){return false}this.$retinaImg.attr("src",this.retinaSrc).load(function(){scope.retinaImageLoaded()})}Retina.prototype.fetchRetinaImage=function(){var imgSrc=this.imageSrc,index=this.imageSrc.search(/(\.|\/)(gif|jpe?g|png)$/i);if(index<0){return false}return imgSrc.substr(0,index)+"@2x"+imgSrc.substr(index,imgSrc.length)};Retina.prototype.retinaImageLoaded=function(){this.$el.attr("src",this.$retinaImg.attr("src")).trigger("gumby.onRetina")};Gumby.addInitalisation("retina",function(){if(!window.devicePixelRatio||window.devicePixelRatio<=1){return}$("img[data-retina],img[gumby-retina],img[retina]").each(function(){var $this=$(this);if($this.data("isRetina")){return true}$this.data("isRetina",true);new Retina($this)})});Gumby.UIModule({module:"retina",events:["onRetina"],init:function(){Gumby.initialize("retina")}})}();!function(){"use strict";function Fixed($el){this.$el=$el;this.fixedPoint="";this.pinPoint=false;this.offset=0;this.pinOffset=0;this.top=0;this.constrainEl=true;this.state=false;this.measurements={left:0,width:0};this.setup();var scope=this;$(window).on("scroll load",function(){scope.monitorScroll()});this.$el.on("gumby.initialize",function(){scope.setup()})}Fixed.prototype.setup=function(){var scope=this;this.fixedPoint=this.parseAttrValue(Gumby.selectAttr.apply(this.$el,["fixed"]));this.pinPoint=Gumby.selectAttr.apply(this.$el,["pin"])||false;this.offset=Number(Gumby.selectAttr.apply(this.$el,["offset"]))||0;this.pinOffset=Number(Gumby.selectAttr.apply(this.$el,["pinoffset"]))||0;this.top=Number(Gumby.selectAttr.apply(this.$el,["top"]))||0;this.constrainEl=Gumby.selectAttr.apply(this.$el,["constrain"])||true;if(this.constrainEl==="false"){this.constrainEl=false}this.$parent=this.$el.parents(".columns, .column, .row");this.$parent=this.$parent.length?this.$parent.first():false;this.parentRow=this.$parent?!!this.$parent.hasClass("row"):false;if(this.pinPoint){this.pinPoint=this.parseAttrValue(this.pinPoint)}if(this.$parent&&this.constrainEl){this.measure();$(window).resize(function(){if(scope.state){scope.measure();scope.constrain()}})}};Fixed.prototype.monitorScroll=function(){var scrollAmount=$(window).scrollTop(),fixedPoint=this.fixedPoint instanceof jQuery?this.fixedPoint.offset().top:this.fixedPoint,pinPoint=false;if(this.pinPoint){pinPoint=this.pinPoint instanceof jQuery?this.pinPoint.offset().top:this.pinPoint}if(this.offset){fixedPoint-=this.offset}if(this.pinOffset){pinPoint-=this.pinOffset}if(scrollAmount>=fixedPoint&&this.state!=="fixed"){if(!pinPoint||scrollAmount<pinPoint){this.fix()}}else if(scrollAmount<fixedPoint&&this.state==="fixed"){this.unfix()}else if(pinPoint&&scrollAmount>=pinPoint&&this.state!=="pinned"){this.pin()}};Fixed.prototype.fix=function(){this.state="fixed";this.$el.css({top:0+this.top}).addClass("fixed").removeClass("unfixed pinned").trigger("gumby.onFixed");if(this.$parent){this.constrain()}};Fixed.prototype.unfix=function(){this.state="unfixed";this.$el.addClass("unfixed").removeClass("fixed pinned").trigger("gumby.onUnfixed")};Fixed.prototype.pin=function(){this.state="pinned";this.$el.css({top:this.$el.offset().top}).addClass("pinned fixed").removeClass("unfixed").trigger("gumby.onPinned")};Fixed.prototype.constrain=function(){this.$el.css({left:this.measurements.left,width:this.measurements.width})};Fixed.prototype.measure=function(){var offsets=this.$parent.offset(),parentPadding;this.measurements.left=offsets.left;this.measurements.width=this.$parent.width();if(this.parentRow){parentPadding=Number(this.$parent.css("paddingLeft").replace(/px/,""));if(parentPadding){this.measurements.left+=parentPadding}}};Fixed.prototype.parseAttrValue=function(attr){if($.isNumeric(attr)){return Number(attr)}else if(attr==="top"){return this.$el.offset().top}else{var $el=$(attr);return $el}};Gumby.addInitalisation("fixed",function(){$("[data-fixed],[gumby-fixed],[fixed]").each(function(){var $this=$(this);if($this.data("isFixed")){return true}$this.data("isFixed",true);new Fixed($this)})});Gumby.UIModule({module:"fixed",events:["onFixed","onUnfixed"],init:function(){Gumby.initialize("fixed")}})}();!function(){"use strict";function SkipLink($el){this.$el=$el;this.targetPos=0;this.duration=0;this.offset=false;this.easing="";this.update=false;this.setup();var scope=this;this.$el.on(Gumby.click+" gumby.skip",function(e){e.stopImmediatePropagation();e.preventDefault();if(scope.update){scope.calculateTarget(scope.skipTo)}else{scope.skipTo()}}).on("gumby.initialize",function(){scope.setup()})}SkipLink.prototype.setup=function(){this.duration=Number(Gumby.selectAttr.apply(this.$el,["duration"]))||200;this.offset=Gumby.selectAttr.apply(this.$el,["offset"])||false;this.easing=Gumby.selectAttr.apply(this.$el,["easing"])||"swing";this.update=Gumby.selectAttr.apply(this.$el,["update"])?true:false;this.calculateTarget()};SkipLink.prototype.calculateTarget=function(cb){var scope=this,target=Gumby.selectAttr.apply(this.$el,["goto"]),$target;if(target=="top"){this.targetPos=0}else if($.isNumeric(target)){this.targetPos=Number(target)}else{$target=$(target);if(!$target){return false}this.targetPos=$target.offset().top}if(cb){cb.apply(this)}};SkipLink.prototype.skipTo=function(){var scope=this;$("html,body").animate({scrollTop:this.calculateOffset()},this.duration,this.easing).promise().done(function(){scope.$el.trigger("gumby.onComplete")})};SkipLink.prototype.calculateOffset=function(){if(!this.offset){return this.targetPos}var op=this.offset.substr(0,1),off=Number(this.offset.substr(1,this.offset.length));if(op==="-"){return this.targetPos-off}else if(op==="+"){return this.targetPos+off}};Gumby.addInitalisation("skiplinks",function(all){$(".skiplink > a, .skip").each(function(){var $this=$(this);if($this.data("isSkipLink")&&!all){return true}else if($this.data("isSkipLink")&&all){$this.trigger("gumby.initialize");return true}$this.data("isSkipLink",true);new SkipLink($this)})});Gumby.UIModule({module:"skiplink",events:["onComplete","skip"],init:function(){Gumby.initialize("skiplinks")}})}();Modernizr.load({test:Modernizr.touch,yep:Gumby.path+"/jquery.mobile.custom.min.js",callback:function(url,result,key){if($.mobile){window.Gumby.click+=" tap"}},complete:function(){window.Gumby.init();if(typeof define=="function"&&define.amd){define(window.Gumby)}}});